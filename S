<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Ù…Ù„Ø¹Ø¨Ù†Ø§ | Ù†Ø¸Ø§Ù… Ø­Ø¬Ø² Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Tajawal', sans-serif; }
        body { background: #f0f7fa; color: #1e3c42; padding: 12px; min-height: 100vh; }
        .container { max-width: 800px; margin: 0 auto; }
        .bg-white { background: white; }
        .text-primary { color: #0a6e79; }
        .bg-primary { background: #0a6e79; color: white; }
        .bg-success { background: #1e7e6c; color: white; }
        .bg-warning { background: #b5624b; color: white; }
        .bg-info { background: #4298a0; color: white; }
        .bg-light { background: #e3f0f2; }
        .border-round { border-radius: 20px; }
        
        .card { background: white; border-radius: 24px; padding: 20px 18px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,50,60,0.08); border: 1px solid #d0e6ea; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 18px; }
        h1, h2, h3 { font-weight: 700; color: #0a5b63; }
        h1 { font-size: 1.9rem; display: flex; align-items: center; gap: 10px; }
        h2 { font-size: 1.5rem; }
        h3 { font-size: 1.2rem; }
        
        .form-row { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 12px; }
        .form-group { flex: 1 1 160px; }
        label { display: block; font-size: 0.85rem; font-weight: 600; color: #1f6a73; margin-bottom: 4px; margin-right: 8px; }
        input, select { width: 100%; padding: 12px 16px; border: 1.5px solid #cde1e5; border-radius: 40px; font-size: 0.95rem; background: white; color: #144f57; font-weight: 500; outline: none; transition: 0.15s; }
        input:focus, select:focus { border-color: #0f8a96; box-shadow: 0 0 0 3px rgba(10,110,121,0.1); }
        
        .btn { border: none; padding: 12px 24px; border-radius: 50px; font-weight: 700; font-size: 1rem; cursor: pointer; transition: 0.1s; display: inline-flex; align-items: center; justify-content: center; gap: 8px; width: 100%; color: white; background: #0f8a96; border-bottom: 4px solid #09616a; }
        .btn:active { transform: translateY(4px); border-bottom-width: 0px; }
        .btn-sm { padding: 8px 18px; font-size: 0.9rem; width: auto; }
        .btn-success { background: #1e8a7a; border-bottom-color: #14635a; }
        .btn-warning { background: #b85c45; border-bottom-color: #8a4534; }
        .btn-outline { background: white; color: #0a6e79; border: 2px solid #0a6e79; border-bottom-width: 4px; border-bottom-color: #0a6e79; }
        .btn-danger { background: #b33f3f; border-bottom-color: #7a2c2c; }
        
        .badge { background: #0a6e79; color: white; padding: 6px 16px; border-radius: 40px; font-size: 0.8rem; font-weight: 700; }
        
        .schedule-day { background: #f2fafc; border-radius: 20px; padding: 16px; margin-bottom: 12px; border: 1px solid #cbe3e7; cursor: pointer; transition: 0.2s; }
        .schedule-day:hover { background: #e3f2f5; }
        .day-title { font-weight: 800; color: #0a6e79; background: #d7f0f3; display: inline-block; padding: 6px 22px; border-radius: 40px; margin-bottom: 14px; font-size: 1.1rem; }
        .hours-container { display: flex; flex-wrap: wrap; gap: 8px; }
        .hour-item { background: #e7f3f5; border-radius: 40px; padding: 8px 12px; font-size: 0.85rem; font-weight: 600; color: #0e5a63; display: inline-flex; align-items: center; gap: 5px; border: 1px solid #b7dce0; flex: 0 0 auto; }
        .hour-booked { background: #edd7d0; color: #612e24; border-color: #c9998a; }
        .hour-ready { background: #b7dfe3; color: #09505a; border-color: #69aeb6; }
        .invite-badge { background: #0f6e78; color: white; padding: 2px 12px; border-radius: 30px; font-size: 0.7rem; font-weight: 700; margin-right: 5px; }
        .suggested-hour { background: #ffd966; color: #1e3c42; border-color: #e0a800; animation: pulse 1s; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        
        .category-grid { display: flex; flex-direction: column; gap: 16px; }
        .category-box { background: #f5fbfc; border-radius: 20px; padding: 16px; border: 1px solid #c6e4e9; }
        .category-header { background: #0a6e79; color: white; padding: 10px 18px; border-radius: 40px; font-weight: 700; display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px; }
        .player-list { max-height: 220px; overflow-y: auto; }
        .player-row { background: white; border-radius: 40px; padding: 10px 16px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #cde1e5; color: #10555e; font-weight: 600; }
        .player-day { background: #d2e9ed; padding: 4px 16px; border-radius: 40px; font-size: 0.75rem; font-weight: 700; }
        
        .admin-panel { background: white; border-radius: 24px; padding: 20px; margin-top: 20px; border: 2px solid #0a6e79; }
        .admin-table { width: 100%; border-collapse: collapse; background: white; border-radius: 16px; font-size: 0.85rem; }
        .admin-table th { background: #0a6e79; color: white; padding: 12px 4px; font-weight: 600; }
        .admin-table td { padding: 10px 4px; border-bottom: 1px solid #d3e7eb; text-align: center; }
        
        .hidden { display: none; }
        .message { background: #0a6e79; color: white; padding: 14px 20px; border-radius: 60px; text-align: center; font-weight: 600; margin-bottom: 15px; animation: slideIn 0.3s; }
        @keyframes slideIn { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .stats { display: flex; justify-content: space-around; background: white; border-radius: 60px; padding: 12px; margin-bottom: 20px; border: 1px solid #bbe0e5; }
        .stat { display: flex; align-items: center; gap: 6px; color: #0a5b63; font-weight: 700; }
        
        .modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .modal-content { background: white; border-radius: 30px; padding: 25px; width: 90%; max-width: 400px; box-shadow: 0 20px 40px rgba(0,0,0,0.2); animation: modalPop 0.2s; }
        @keyframes modalPop { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .modal-title { font-size: 1.3rem; font-weight: 700; color: #0a6e79; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .modal-buttons { display: flex; gap: 12px; margin-top: 25px; }
        
        .search-section { background: #e3f2f5; border-radius: 60px; padding: 15px 20px; margin-bottom: 20px; }
        .search-input { width: 100%; padding: 12px 16px; border-radius: 40px; border: 1.5px solid #cde1e5; margin-bottom: 10px; }
        .search-result { background: white; border-radius: 30px; padding: 20px; margin-top: 15px; border: 2px solid #0a6e79; }
        .delete-player-btn { background: #b85c45; color: white; border: none; padding: 8px 20px; border-radius: 40px; font-weight: 700; cursor: pointer; border-bottom: 3px solid #7a3f2e; margin-top: 10px; width: 100%; }
        .delete-player-btn:active { transform: translateY(3px); border-bottom-width: 0px; }
        
        @media (max-width: 600px) { 
            .form-group { flex: 1 1 100%; } 
            h1 { font-size: 1.7rem; }
            .modal-content { width: 95%; padding: 20px; }
            .admin-table { font-size: 0.75rem; }
            .admin-table td, .admin-table th { padding: 8px 2px; }
            .hour-item { font-size: 0.75rem; padding: 6px 8px; }
        }
        @media (max-width: 380px) {
            .stats { flex-direction: column; align-items: center; gap: 8px; }
            .day-title { font-size: 0.95rem; }
        }
        .hour-item i { font-size: 0.7rem; }
        .btn i { font-size: 1rem; }
        .modal-buttons .btn { width: 100%; }
    </style>
</head>
<body>
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; flex-wrap: wrap;">
            <h1><i class="fas fa-futbol" style="color: #0a6e79;"></i> Ù…Ù„Ø¹Ø¨Ù†Ø§</h1>
            <div class="stats">
                <span class="stat"><i class="fas fa-users"></i> <span id="totalPlayers">0</span></span>
                <span class="stat"><i class="fas fa-calendar"></i> <span id="totalMatches">0</span></span>
                <span class="stat"><i class="fas fa-clock"></i> <span id="readyMatches">0</span></span>
            </div>
        </div>

        <div class="search-section">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <i class="fas fa-search" style="color: #0a6e79; font-size: 1.3rem;"></i>
                <h3 style="margin: 0; color: #0a6e79;">Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù„Ø§Ø¹Ø¨</h3>
            </div>
            <input type="text" id="searchPlayerName" class="search-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù„Ù„Ø¨Ø­Ø«..." autocomplete="off">
            <button class="btn-sm btn-success" id="searchPlayerBtn" style="width: 100%;">Ø¨Ø­Ø«</button>
            <div id="searchResult"></div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-user-plus" style="color: #0a6e79;"></i> ØªØ³Ø¬ÙŠÙ„ Ù„Ø§Ø¹Ø¨</h2>
                <span class="badge">ÙŠÙƒØªÙ…Ù„ 12</span>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                    <input type="text" id="fullName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…" autocomplete="off">
                </div>
                <div class="form-group">
                    <label>Ø§Ù„Ø¹Ù…Ø±</label>
                    <input type="number" id="age" placeholder="Ø§Ù„Ø¹Ù…Ø±" min="5" max="100" step="1">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                    <select id="targetCategory">
                        <option value="12-15">12 - 15 Ø³Ù†Ø©</option>
                        <option value="15-18">15 - 18 Ø³Ù†Ø©</option>
                        <option value="18-24">18 - 24 Ø³Ù†Ø©</option>
                        <option value="24-35">24 - 35 Ø³Ù†Ø©</option>
                        <option value="35plus">35 ÙÙ…Ø§ ÙÙˆÙ‚</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Ø§Ù„ÙŠÙˆÙ…</label>
                    <select id="matchDay">
                        <option value="Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†">Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†</option>
                        <option value="Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡">Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option>
                        <option value="Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option>
                        <option value="Ø§Ù„Ø®Ù…ÙŠØ³">Ø§Ù„Ø®Ù…ÙŠØ³</option>
                        <option value="Ø§Ù„Ø¬Ù…Ø¹Ø©">Ø§Ù„Ø¬Ù…Ø¹Ø©</option>
                        <option value="Ø§Ù„Ø³Ø¨Øª">Ø§Ù„Ø³Ø¨Øª</option>
                        <option value="Ø§Ù„Ø£Ø­Ø¯">Ø§Ù„Ø£Ø­Ø¯</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Ø§Ù„Ø³Ø§Ø¹Ø©</label>
                    <select id="matchHour"></select>
                </div>
            </div>
            
            <button class="btn" id="registerPlayerBtn">
                <i class="fas fa-check-circle"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨
            </button>
        </div>

        <div class="card" style="background: #f6fbfc;">
            <div class="card-header">
                <h3><i class="fas fa-bolt" style="color: #0a6e79;"></i> Ù…Ø¨Ø§Ø±Ø§Ø© Ø¬Ø§Ù‡Ø²Ø© (12 Ù„Ø§Ø¹Ø¨)</h3>
                <span class="badge" style="background: #0f8a96;">ÙƒÙˆØ¯ 6 Ø£Ø±Ù‚Ø§Ù…</span>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>Ø§Ù„ÙŠÙˆÙ…</label>
                    <select id="readyDay">
                        <option value="Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†">Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†</option>
                        <option value="Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡">Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option>
                        <option value="Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option>
                        <option value="Ø§Ù„Ø®Ù…ÙŠØ³">Ø§Ù„Ø®Ù…ÙŠØ³</option>
                        <option value="Ø§Ù„Ø¬Ù…Ø¹Ø©">Ø§Ù„Ø¬Ù…Ø¹Ø©</option>
                        <option value="Ø§Ù„Ø³Ø¨Øª">Ø§Ù„Ø³Ø¨Øª</option>
                        <option value="Ø§Ù„Ø£Ø­Ø¯">Ø§Ù„Ø£Ø­Ø¯</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Ø§Ù„Ø³Ø§Ø¹Ø©</label>
                    <select id="readyHour"></select>
                </div>
                <div class="form-group">
                    <label>ÙƒÙˆØ¯ 6 Ø£Ø±Ù‚Ø§Ù…</label>
                    <input type="number" id="readyCode" placeholder="Ù…Ø«Ø§Ù„: 123456" min="100000" max="999999" oninput="this.value = this.value.slice(0,6)">
                </div>
            </div>
            
            <button class="btn btn-success" id="bookReadyMatchBtn">
                <i class="fas fa-calendar-plus"></i> Ø­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø© Ø¬Ø§Ù‡Ø²Ø©
            </button>
        </div>

        <div class="card">
            <h2 style="margin-bottom: 15px;"><i class="fas fa-table"></i> Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ (Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ù„Ù„Ø­Ø°Ù)</h2>
            <div id="verticalScheduleContainer"></div>
            <div style="display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; justify-content: center;">
                <span style="background: #e7f3f5; padding: 5px 18px; border-radius: 30px;"><i class="fas fa-circle" style="color: #4298a0;"></i> ÙØ§Ø±Øº</span>
                <span style="background: #edd7d0; padding: 5px 18px; border-radius: 30px;"><i class="fas fa-circle" style="color: #b5624b;"></i> Ù…Ø¨Ø§Ø±Ø§Ø© Ø¹Ø§Ø¯ÙŠØ©</span>
                <span style="background: #b7dfe3; padding: 5px 18px; border-radius: 30px;"><i class="fas fa-circle" style="color: #0f8a96;"></i> Ù…Ø¨Ø§Ø±Ø§Ø© Ø¬Ø§Ù‡Ø²Ø©</span>
                <span style="background: #ffd966; padding: 5px 18px; border-radius: 30px;"><i class="fas fa-star" style="color: #e0a800;"></i> Ø³Ø§Ø¹Ø© Ù…Ù‚ØªØ±Ø­Ø©</span>
                <span style="background: #0a6e79; color: white; padding: 5px 18px; border-radius: 30px;"><i class="fas fa-check"></i> ØªÙ…Øª Ø§Ù„Ø¯Ø¹ÙˆØ©</span>
            </div>
        </div>

        <div class="card">
            <h2 style="margin-bottom: 15px;"><i class="fas fa-users-between-lines"></i> Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</h2>
            <div id="categoriesContainer" class="category-grid"></div>
        </div>

        <div class="admin-panel">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px;">
                <h3 style="margin: 0;"><i class="fas fa-cog"></i> Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
                <button id="toggleAdminBtn" class="btn-sm btn-outline" style="width: auto;">
                    <i class="fas fa-lock"></i> Ø¥Ø¯Ø§Ø±Ø©
                </button>
            </div>
            
            <div id="adminContent" class="hidden">
                <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: flex-end; margin-bottom: 20px;">
                    <div style="flex: 1; min-width: 150px;">
                        <label>ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</label>
                        <input type="password" id="adminCode" placeholder="****" maxlength="4">
                    </div>
                    <div>
                        <button class="btn-sm btn-success" id="unlockAdminBtn">ÙØªØ­</button>
                    </div>
                </div>
                <div id="adminStats" style="background: #e3f2f5; border-radius: 30px; padding: 18px; margin-bottom: 20px;"></div>
                <div id="adminPanelContainer"></div>
                
                <div style="margin-top: 25px; border-top: 2px dashed #0a6e79; padding-top: 20px;">
                    <button id="resetSystemBtn" class="btn btn-danger" style="width: 100%;">
                        <i class="fas fa-exclamation-triangle"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù†Ø¸Ø§Ù… (Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„)
                    </button>
                </div>
            </div>
        </div>

        <div id="deleteModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-title">
                    <i class="fas fa-trash-alt" style="color: #b5624b;"></i> Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©
                </div>
                <p id="modalMatchInfo" style="font-weight: 600; margin-bottom: 15px;"></p>
                <div style="margin-bottom: 15px;">
                    <label>Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø­Ø°Ù</label>
                    <input type="password" id="deleteCode" placeholder="ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø£Ùˆ ****" style="width: 100%; margin-top: 8px;">
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-warning" id="confirmDeleteBtn" style="width: 50%;">Ø­Ø°Ù</button>
                    <button class="btn btn-outline" id="cancelDeleteBtn" style="width: 50%;">Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </div>
        </div>

        <div id="resetModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-title">
                    <i class="fas fa-exclamation-triangle" style="color: #b33f3f;"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù†Ø¸Ø§Ù…
                </div>
                <p style="font-weight: 600; margin-bottom: 20px;">âš ï¸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª ÙˆØ¬Ù…ÙŠØ¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹</p>
                <div style="margin-bottom: 15px;">
                    <label>Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</label>
                    <input type="password" id="resetCode" placeholder="****" style="width: 100%; margin-top: 8px;">
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-danger" id="confirmResetBtn" style="width: 50%;">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¶Ø¨Ø·</button>
                    <button class="btn btn-outline" id="cancelResetBtn" style="width: 50%;">Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </div>
        </div>

        <div id="messageContainer" style="margin-top: 15px;"></div>
    </div>

    <script>
        (function() {
            "use strict";

            // -------------------- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© --------------------
            const HOURS_SIMPLE = [];
            for (let i = 8; i <= 22; i++) {
                HOURS_SIMPLE.push(i + ':00');
            }
            
            const HOURS_DISPLAY = [];
            for (let i = 8; i <= 22; i++) {
                if (i <= 11) HOURS_DISPLAY.push(i + ':00 Øµ');
                else if (i === 12) HOURS_DISPLAY.push(i + ':00 Ù…');
                else HOURS_DISPLAY.push((i - 12) + ':00 Ù…');
            }
            
            const DAYS = ['Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª', 'Ø§Ù„Ø£Ø­Ø¯'];
            const AGE_CATEGORIES = ['12-15', '15-18', '18-24', '24-35', '35plus'];

            // -------------------- LocalStorage --------------------
            let players = [];
            let matches = [];

            try {
                players = JSON.parse(localStorage.getItem('playground_players')) || [];
                matches = JSON.parse(localStorage.getItem('playground_matches')) || [];
            } catch (e) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', e);
                players = [];
                matches = [];
            }

            let currentDeleteDay = null;
            let currentDeleteHour = null;
            let suggestedHourMatch = null; // Ù„ØªØ®Ø²ÙŠÙ† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©

            // -------------------- Ø¯ÙˆØ§Ù„ Ø§Ù„Ø­ÙØ¸ --------------------
            function saveAll() {
                try {
                    localStorage.setItem('playground_players', JSON.stringify(players));
                    localStorage.setItem('playground_matches', JSON.stringify(matches));
                    updateStats();
                } catch (e) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', e);
                    showMsg('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', false);
                }
            }

            // -------------------- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª --------------------
            function updateStats() {
                const totalPlayersEl = document.getElementById('totalPlayers');
                const totalMatchesEl = document.getElementById('totalMatches');
                const readyMatchesEl = document.getElementById('readyMatches');
                
                if (totalPlayersEl) totalPlayersEl.innerText = players.length;
                if (totalMatchesEl) totalMatchesEl.innerText = matches.length;
                if (readyMatchesEl) readyMatchesEl.innerText = matches.filter(m => m.type === 'ready').length;
            }

            // -------------------- Ù…Ù„Ø¡ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø³Ø§Ø¹Ø§Øª --------------------
            function fillHours() {
                let matchHourSel = document.getElementById('matchHour');
                if (matchHourSel) {
                    matchHourSel.innerHTML = '';
                    HOURS_SIMPLE.forEach((hour, index) => {
                        let opt = document.createElement('option');
                        opt.value = hour;
                        opt.textContent = HOURS_DISPLAY[index];
                        matchHourSel.appendChild(opt);
                    });
                }
                
                let readyHourSel = document.getElementById('readyHour');
                if (readyHourSel) {
                    readyHourSel.innerHTML = '';
                    HOURS_SIMPLE.forEach((hour, index) => {
                        let opt = document.createElement('option');
                        opt.value = hour;
                        opt.textContent = HOURS_DISPLAY[index];
                        readyHourSel.appendChild(opt);
                    });
                }
            }

            // -------------------- Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ --------------------
            function showMsg(text, success = true, isSuggestion = false) {
                let msgDiv = document.getElementById('messageContainer');
                if (msgDiv) {
                    let bgColor = success ? '#0a6e79' : '#b5624b';
                    if (isSuggestion) bgColor = '#ffd966';
                    let textColor = isSuggestion ? '#1e3c42' : 'white';
                    
                    msgDiv.innerHTML = `<div class="message" style="background: ${bgColor}; color: ${textColor};">${text}</div>`;
                    setTimeout(() => msgDiv.innerHTML = '', isSuggestion ? 8000 : 3000);
                }
            }

            // -------------------- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¹Ù…Ø± --------------------
            function isValidAge(age, cat) {
                if (age === null || age === undefined || age === '') return false;
                age = parseInt(age);
                if (isNaN(age) || age < 1) return false;
                
                switch(cat) {
                    case '12-15': return age >= 12 && age <= 15;
                    case '15-18': return age >= 15 && age <= 18;
                    case '18-24': return age >= 18 && age <= 24;
                    case '24-35': return age >= 24 && age <= 35;
                    case '35plus': return age >= 35;
                    default: return false;
                }
            }

            // -------------------- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙƒØ±Ø§Ø± Ø§Ù„ÙƒÙˆØ¯ --------------------
            function isCodeExists(code) {
                return matches.some(m => m.type === 'ready' && m.code == code);
            }

            // -------------------- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ù‚Ø±Ø¨ Ø³Ø§Ø¹Ø© ÙØ§Ø±ØºØ© ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙŠÙˆÙ… --------------------
            function findNearestAvailableHour(day, targetHour) {
                console.log(`ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ù‚Ø±Ø¨ Ø³Ø§Ø¹Ø© ÙØ§Ø±ØºØ© Ù„Ù€ ${day} ${targetHour}`);
                
                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© Ø¥Ù„Ù‰ Ø±Ù‚Ù… Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
                let targetIndex = HOURS_SIMPLE.indexOf(targetHour);
                if (targetIndex === -1) return null;
                
                // Ø§Ù„Ø¨Ø­Ø« Ù„Ù„Ø£Ù…Ø§Ù… (Ø³Ø§Ø¹Ø§Øª Ø£Ø­Ø¯Ø«)
                for (let i = targetIndex + 1; i < HOURS_SIMPLE.length; i++) {
                    let hour = HOURS_SIMPLE[i];
                    let isBooked = matches.some(m => m.day === day && m.hour === hour);
                    if (!isBooked) {
                        console.log(`âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø³Ø§Ø¹Ø© ÙØ§Ø±ØºØ© Ø£Ø­Ø¯Ø«: ${hour}`);
                        return { hour: hour, direction: 'forward', index: i };
                    }
                }
                
                // Ø§Ù„Ø¨Ø­Ø« Ù„Ù„Ø®Ù„Ù (Ø³Ø§Ø¹Ø§Øª Ø£Ù‚Ø¯Ù…)
                for (let i = targetIndex - 1; i >= 0; i--) {
                    let hour = HOURS_SIMPLE[i];
                    let isBooked = matches.some(m => m.day === day && m.hour === hour);
                    if (!isBooked) {
                        console.log(`âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø³Ø§Ø¹Ø© ÙØ§Ø±ØºØ© Ø£Ù‚Ø¯Ù…: ${hour}`);
                        return { hour: hour, direction: 'backward', index: i };
                    }
                }
                
                console.log(`âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø§Ø¹Ø§Øª ÙØ§Ø±ØºØ© ÙÙŠ ÙŠÙˆÙ… ${day}`);
                return null;
            }

            // -------------------- Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù†Ø¸Ø§Ù… --------------------
            function resetSystem(adminCode) {
                if (adminCode === '****') {
                    localStorage.removeItem('playground_players');
                    localStorage.removeItem('playground_matches');
                    players = [];
                    matches = [];
                    saveAll();
                    renderAll();
                    
                    const adminContent = document.getElementById('adminContent');
                    if (adminContent) adminContent.classList.add('hidden');
                    
                    showMsg('âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­');
                    return true;
                } else {
                    showMsg('âŒ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ØºÙŠØ± ØµØ­ÙŠØ­', false);
                    return false;
                }
            }

            // -------------------- Ø­Ø°Ù Ù„Ø§Ø¹Ø¨ --------------------
            function deletePlayer(playerId) {
                players = players.filter(p => p.id !== playerId);
                saveAll();
                renderAll();
                
                const searchInput = document.getElementById('searchPlayerName');
                if (searchInput && searchInput.value.trim()) {
                    setTimeout(() => searchPlayer(), 100);
                }
                
                showMsg('âœ… ØªÙ… Ø­Ø°Ù Ø§Ø³Ù…Ùƒ Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±');
            }

            // -------------------- Ø­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø© (Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù†Ø©) --------------------
            function bookMatchForPlayers(cat, day, originalHour, playersList) {
                console.log(`ğŸ¯ Ù…Ø­Ø§ÙˆÙ„Ø© Ø­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø© Ù„Ù€ ${playersList.length} Ù„Ø§Ø¹Ø¨ ÙÙŠ ${day} ${originalHour}`);
                
                // Ø£ÙˆÙ„Ø§Ù‹: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©
                let targetDay = day;
                let targetHour = originalHour;
                let isOriginalAvailable = !matches.some(m => m.day === targetDay && m.hour === targetHour);
                
                if (isOriginalAvailable) {
                    // Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© ÙØ§Ø±ØºØ© - Ù†Ø­Ø¬Ø² ÙÙŠÙ‡Ø§
                    let newMatch = {
                        id: 'M' + Date.now() + '-' + Math.random().toString(36).substr(2, 5),
                        day: targetDay,
                        hour: targetHour,
                        type: 'normal',
                        category: cat,
                        players: playersList.map(p => p.name),
                        code: null,
                        bookedAt: new Date().toISOString()
                    };
                    
                    matches.push(newMatch);
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
                    let idsToRemove = playersList.map(p => p.id);
                    players = players.filter(p => !idsToRemove.includes(p.id));
                    
                    saveAll();
                    
                    let hourDisplay = targetHour;
                    const hourIndex = HOURS_SIMPLE.indexOf(targetHour);
                    if (hourIndex !== -1) hourDisplay = HOURS_DISPLAY[hourIndex];
                    
                    showMsg(`ğŸ‰ğŸ‰ Ø§ÙƒØªÙ…Ù„ 12 Ù„Ø§Ø¹Ø¨! ØªÙ… Ø­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø©: ${day} ${hourDisplay} - ÙØ¦Ø© ${cat}`, true);
                    return true;
                }
                else {
                    // Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù…Ø­Ø¬ÙˆØ²Ø© - Ù†Ø¨Ø­Ø« Ø¹Ù† Ø£Ù‚Ø±Ø¨ Ø³Ø§Ø¹Ø© ÙØ§Ø±ØºØ©
                    let nearestHour = findNearestAvailableHour(day, originalHour);
                    
                    if (nearestHour) {
                        // ÙˆØ¬Ø¯Ù†Ø§ Ø³Ø§Ø¹Ø© ÙØ§Ø±ØºØ© - Ù†Ø­Ø¬Ø² ÙÙŠÙ‡Ø§
                        let newMatch = {
                            id: 'M' + Date.now() + '-' + Math.random().toString(36).substr(2, 5),
                            day: day,
                            hour: nearestHour.hour,
                            type: 'normal',
                            category: cat,
                            players: playersList.map(p => p.name),
                            code: null,
                            bookedAt: new Date().toISOString(),
                            isSuggested: true,
                            originalHour: originalHour
                        };
                        
                        matches.push(newMatch);
                        
                        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
                        let idsToRemove = playersList.map(p => p.id);
                        players = players.filter(p => !idsToRemove.includes(p.id));
                        
                        saveAll();
                        
                        let originalHourDisplay = originalHour;
                        let newHourDisplay = nearestHour.hour;
                        const originalIndex = HOURS_SIMPLE.indexOf(originalHour);
                        const newIndex = HOURS_SIMPLE.indexOf(nearestHour.hour);
                        
                        if (originalIndex !== -1) originalHourDisplay = HOURS_DISPLAY[originalIndex];
                        if (newIndex !== -1) newHourDisplay = HOURS_DISPLAY[newIndex];
                        
                        let directionText = nearestHour.direction === 'forward' ? 'Ù…ØªØ£Ø®Ø±Ø©' : 'Ù…Ø¨ÙƒØ±Ø©';
                        
                        showMsg(`ğŸ”„ Ø§Ù„Ø³Ø§Ø¹Ø© ${originalHourDisplay} Ù…Ø­Ø¬ÙˆØ²Ø©! ØªÙ… Ø­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø© ÙÙŠ ${newHourDisplay} (${directionText}) - ÙØ¦Ø© ${cat}`, true, true);
                        
                        // ØªØ®Ø²ÙŠÙ† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© Ù„Ù„ØªØ£ÙƒÙŠØ¯
                        suggestedHourMatch = {
                            day: day,
                            originalHour: originalHour,
                            newHour: nearestHour.hour,
                            category: cat
                        };
                        
                        return true;
                    }
                    else {
                        // Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø§Ø¹Ø§Øª ÙØ§Ø±ØºØ© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…
                        showMsg(`âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø§Ø¹Ø§Øª ÙØ§Ø±ØºØ© ÙÙŠ ÙŠÙˆÙ… ${day} - Ù„Ù… ÙŠØªÙ… Ø­Ø¬Ø² Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©`, false);
                        return false;
                    }
                }
            }

            // -------------------- ØªØ³Ø¬ÙŠÙ„ Ù„Ø§Ø¹Ø¨ --------------------
            function register() {
                console.log('ØªØ³Ø¬ÙŠÙ„ Ù„Ø§Ø¹Ø¨ Ø¬Ø¯ÙŠØ¯...');
                
                let name = document.getElementById('fullName').value.trim();
                let age = document.getElementById('age').value.trim();
                let cat = document.getElementById('targetCategory').value;
                let day = document.getElementById('matchDay').value;
                let hourSelect = document.getElementById('matchHour');
                let hour = hourSelect.value;

                if (!name || !age) {
                    showMsg('âŒ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø¹Ù…Ø±', false);
                    return;
                }
                
                if (name.length < 2) {
                    showMsg('âŒ Ø§Ù„Ø§Ø³Ù… Ù‚ØµÙŠØ± Ø¬Ø¯Ø§Ù‹', false);
                    return;
                }
                
                const ageNum = parseInt(age);
                if (isNaN(ageNum) || ageNum < 5 || ageNum > 100) {
                    showMsg('âŒ Ø§Ù„Ø¹Ù…Ø± ØºÙŠØ± ØµØ­ÙŠØ­ (ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 5 Ùˆ 100)', false);
                    return;
                }
                
                if (!isValidAge(ageNum, cat)) {
                    showMsg('âŒ Ø§Ù„Ø¹Ù…Ø± Ù„Ø§ ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©', false);
                    return;
                }

                const existingPlayer = players.find(p => 
                    p.name.toLowerCase() === name.toLowerCase() && 
                    p.day === day && 
                    p.hour === hour
                );
                
                if (existingPlayer) {
                    showMsg('âŒ Ù‡Ø°Ø§ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø³Ø§Ø¹Ø©', false);
                    return;
                }

                let newPlayer = {
                    id: Date.now() + '-' + Math.random().toString(36).substr(2, 5),
                    name: name,
                    age: ageNum,
                    targetCategory: cat,
                    day: day,
                    hour: hour,
                    registeredAt: new Date().toISOString()
                };
                
                players.push(newPlayer);
                console.log('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„Ø§Ø¹Ø¨:', newPlayer);
                
                saveAll();
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ÙƒØªÙ…Ø§Ù„ 12 Ù„Ø§Ø¹Ø¨ ÙˆØ­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø© (Ù…Ø¹ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø³Ø§Ø¹Ø© Ø¨Ø¯ÙŠÙ„Ø© Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±)
                checkAndBookMatchIfFull(cat, day, hour);
                
                renderAll();
                
                let hourDisplay = hour;
                const hourIndex = HOURS_SIMPLE.indexOf(hour);
                if (hourIndex !== -1) hourDisplay = HOURS_DISPLAY[hourIndex];
                
                showMsg(`âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${name} Ø¨Ù†Ø¬Ø§Ø­ ÙÙŠ ${day} ${hourDisplay}`);
                
                document.getElementById('fullName').value = '';
                document.getElementById('age').value = '';
            }

            // -------------------- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ÙƒØªÙ…Ø§Ù„ 12 Ù„Ø§Ø¹Ø¨ ÙˆØ­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø© (Ù…Ø­Ø³Ù†Ø©) --------------------
            function checkAndBookMatchIfFull(cat, day, hour) {
                let candidates = players.filter(p => 
                    p.targetCategory === cat && 
                    p.day === day && 
                    p.hour === hour
                );
                
                console.log(`ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙÙŠ ${day} ${hour} ÙØ¦Ø© ${cat}: ${candidates.length}`);
                
                while (candidates.length >= 12) {
                    // Ø£Ø®Ø° Ø£ÙˆÙ„ 12 Ù„Ø§Ø¹Ø¨
                    let playersToBook = candidates.slice(0, 12);
                    
                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø© Ù„Ù‡Ù…
                    let booked = bookMatchForPlayers(cat, day, hour, playersToBook);
                    
                    if (booked) {
                        // ØªÙ… Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­ - ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ†
                        candidates = players.filter(p => 
                            p.targetCategory === cat && 
                            p.day === day && 
                            p.hour === hour
                        );
                    } else {
                        // ÙØ´Ù„ Ø§Ù„Ø­Ø¬Ø² - Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø§Ø¹Ø§Øª ÙØ§Ø±ØºØ©
                        break;
                    }
                }
            }

            // -------------------- Ø­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø© Ø¬Ø§Ù‡Ø²Ø© --------------------
            function bookReady() {
                let day = document.getElementById('readyDay').value;
                let hourSelect = document.getElementById('readyHour');
                let hour = hourSelect.value;
                let code = document.getElementById('readyCode').value.trim();

                console.log('Ø­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø© Ø¬Ø§Ù‡Ø²Ø©:', { day, hour, code });

                if (!code || code.length !== 6 || isNaN(code)) {
                    showMsg('âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ ØµØ­ÙŠØ­ Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù…', false);
                    return;
                }
                
                if (matches.some(m => m.day === day && m.hour === hour)) {
                    showMsg('âŒ Ù‡Ø°Ù‡ Ø§Ù„Ø³Ø§Ø¹Ø© Ù…Ø­Ø¬ÙˆØ²Ø© Ø¨Ø§Ù„ÙØ¹Ù„ Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø£Ø®Ø±Ù‰', false);
                    return;
                }
                
                if (isCodeExists(code)) {
                    showMsg('âŒ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŒ Ø§Ø®ØªØ± ÙƒÙˆØ¯ Ø¢Ø®Ø±', false);
                    return;
                }

                matches.push({
                    id: 'R' + Date.now() + '-' + Math.random().toString(36).substr(2, 5),
                    day: day,
                    hour: hour,
                    type: 'ready',
                    category: 'Ø¬Ø§Ù‡Ø²Ø©',
                    code: code,
                    players: ['Ù…Ø¨Ø§Ø±Ø§Ø© Ø¬Ø§Ù‡Ø²Ø©'],
                    bookedAt: new Date().toISOString()
                });
                
                saveAll();
                renderAll();
                
                const adminContent = document.getElementById('adminContent');
                if (adminContent && !adminContent.classList.contains('hidden')) {
                    renderAdmin();
                }
                
                let hourDisplay = hour;
                const hourIndex = HOURS_SIMPLE.indexOf(hour);
                if (hourIndex !== -1) hourDisplay = HOURS_DISPLAY[hourIndex];
                
                showMsg(`âœ… ØªÙ… Ø­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø© Ø¬Ø§Ù‡Ø²Ø© Ø¨ÙƒÙˆØ¯ ${code} ÙÙŠ ${day} ${hourDisplay}`);
                document.getElementById('readyCode').value = '';
            }

            // -------------------- Ø­Ø°Ù Ù…Ø¨Ø§Ø±Ø§Ø© --------------------
            function deleteMatch(day, hour, inputCode) {
                let match = matches.find(m => m.day === day && m.hour === hour);
                if (!match) {
                    showMsg('âŒ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©', false);
                    return false;
                }

                let deleted = false;
                
                if (match.type === 'ready' && match.code == inputCode) {
                    matches = matches.filter(m => !(m.day === day && m.hour === hour));
                    deleted = true;
                    showMsg('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© Ø¨Ù†Ø¬Ø§Ø­');
                }
                else if (inputCode === '****') {
                    matches = matches.filter(m => !(m.day === day && m.hour === hour));
                    deleted = true;
                    showMsg('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©');
                }
                else {
                    showMsg('âŒ Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­', false);
                    return false;
                }
                
                if (deleted) {
                    saveAll();
                    renderAll();
                    
                    const adminContent = document.getElementById('adminContent');
                    if (adminContent && !adminContent.classList.contains('hidden')) {
                        renderAdmin();
                    }
                    
                    return true;
                }
            }

            // -------------------- ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø­Ø°Ù --------------------
            function openDeleteModal(day, hour) {
                let match = matches.find(m => m.day === day && m.hour === hour);
                if (!match) {
                    showMsg('âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø³Ø§Ø¹Ø© ÙØ§Ø±ØºØ©', false);
                    return;
                }
                currentDeleteDay = day;
                currentDeleteHour = hour;
                
                const modalMatchInfo = document.getElementById('modalMatchInfo');
                if (modalMatchInfo) {
                    modalMatchInfo.innerHTML = `Ø­Ø°Ù Ù…Ø¨Ø§Ø±Ø§Ø© ${day} ${hour}<br>Ø§Ù„Ù†ÙˆØ¹: ${match.type === 'ready' ? 'Ø¬Ø§Ù‡Ø²Ø©' : 'Ø¹Ø§Ø¯ÙŠØ©'}`;
                }
                
                const deleteCode = document.getElementById('deleteCode');
                if (deleteCode) deleteCode.value = '';
                
                const deleteModal = document.getElementById('deleteModal');
                if (deleteModal) deleteModal.style.display = 'flex';
            }

            // -------------------- Ø¯ÙˆØ§Ù„ Ø¹Ø§Ù…Ø© Ù„Ù„Ù€ onclick --------------------
            window.openDeleteModalFromHour = function(day, hour) {
                openDeleteModal(day, hour);
            };

            window.openDeleteModalFromSchedule = function(day) {}

            window.deletePlayerFromSearch = function(playerId) {
                if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ø³Ù…Ùƒ Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±ØŸ')) {
                    deletePlayer(playerId);
                    document.getElementById('searchPlayerName').value = '';
                    document.getElementById('searchResult').innerHTML = '';
                    showMsg('âœ… ØªÙ… Ø­Ø°Ù Ø§Ø³Ù…Ùƒ Ø¨Ù†Ø¬Ø§Ø­');
                }
            };

            window.deleteReadyCodeFromAdmin = function(code, day, hour) {
                if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©ØŸ')) {
                    matches = matches.filter(m => !(m.type === 'ready' && m.code == code && m.day === day && m.hour === hour));
                    saveAll();
                    renderAll();
                    renderAdmin();
                    showMsg('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© Ø¨Ù†Ø¬Ø§Ø­');
                }
            };

            window.deleteNormalMatchFromAdmin = function(day, hour) {
                if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©ØŸ')) {
                    matches = matches.filter(m => !(m.type === 'normal' && m.day === day && m.hour === hour));
                    saveAll();
                    renderAll();
                    renderAdmin();
                    showMsg('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
                }
            };

            // -------------------- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù„Ø§Ø¹Ø¨ --------------------
            function searchPlayer() {
                let searchName = document.getElementById('searchPlayerName').value.trim().toLowerCase();
                let resultDiv = document.getElementById('searchResult');
                
                if (!searchName) {
                    resultDiv.innerHTML = '';
                    return;
                }

                let inMatches = [];
                matches.forEach(m => {
                    if (m.players && m.players.some(p => 
                        typeof p === 'string' && p.toLowerCase().includes(searchName)
                    )) {
                        inMatches.push(m);
                    }
                });

                let inWaiting = players.filter(p => 
                    p.name && p.name.toLowerCase().includes(searchName)
                );

                if (inMatches.length > 0) {
                    let match = inMatches[0];
                    let hourDisplay = match.hour;
                    const hourIndex = HOURS_SIMPLE.indexOf(match.hour);
                    if (hourIndex !== -1) hourDisplay = HOURS_DISPLAY[hourIndex];
                    
                    let suggestionText = '';
                    if (match.isSuggested && match.originalHour) {
                        let originalHourDisplay = match.originalHour;
                        const originalIndex = HOURS_SIMPLE.indexOf(match.originalHour);
                        if (originalIndex !== -1) originalHourDisplay = HOURS_DISPLAY[originalIndex];
                        suggestionText = `<p style="margin-top: 10px; color: #ffd700;"><i class="fas fa-star"></i> ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ù…Ù† ${originalHourDisplay}</p>`;
                    }
                    
                    resultDiv.innerHTML = `<div class="search-result" style="background: #0a6e79; color: white;">
                        <i class="fas fa-check-circle" style="font-size: 1.5rem;"></i>
                        <h3 style="color: white; margin: 10px 0;">âœ… Ø£Ù†Øª ÙÙŠ Ù…Ø¨Ø§Ø±Ø§Ø©!</h3>
                        <p style="font-size: 1.1rem;">ğŸ“… ${match.day} | â° ${hourDisplay}</p>
                        <p>ğŸ† ${match.type === 'ready' ? 'Ù…Ø¨Ø§Ø±Ø§Ø© Ø¬Ø§Ù‡Ø²Ø©' : 'Ù…Ø¨Ø§Ø±Ø§Ø© Ø¹Ø§Ø¯ÙŠØ©'}</p>
                        ${suggestionText}
                        <p style="margin-top: 15px; color: #ffd700;"><i class="fas fa-info-circle"></i> Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø§Ø³Ù…Ùƒ Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©</p>
                    </div>`;
                }
                else if (inWaiting.length > 0) {
                    let player = inWaiting[0];
                    let needed = 12 - players.filter(p => 
                        p.targetCategory === player.targetCategory && 
                        p.day === player.day && 
                        p.hour === player.hour
                    ).length;
                    
                    let hourDisplay = player.hour;
                    const hourIndex = HOURS_SIMPLE.indexOf(player.hour);
                    if (hourIndex !== -1) hourDisplay = HOURS_DISPLAY[hourIndex];
                    
                    resultDiv.innerHTML = `<div class="search-result" style="background: #e3f2f5;">
                        <i class="fas fa-clock" style="color: #0a6e79; font-size: 1.5rem;"></i>
                        <h3 style="color: #0a6e79; margin: 10px 0;">â³ Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ù…Ø¨Ø§Ø±Ø§Ø© Ù„Ùƒ</h3>
                        <p style="font-size: 1.1rem; color: #0a5b63;">ğŸ“… ${player.day} | â° ${hourDisplay}</p>
                        <p style="color: #0a6e79;">ÙØ¦Ø©: ${player.targetCategory}</p>
                        <p style="color: #0a6e79; font-weight: 700;">âš ï¸ ØªØ­ØªØ§Ø¬ ${needed} Ù„Ø§Ø¹Ø¨ Ù„Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©</p>
                        <button class="delete-player-btn" onclick="deletePlayerFromSearch('${player.id}')">
                            <i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ø§Ø³Ù…ÙŠ Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
                        </button>
                    </div>`;
                }
                else {
                    resultDiv.innerHTML = `<div class="search-result" style="background: #f5f5f5;">
                        <i class="fas fa-search" style="color: #666; font-size: 1.5rem;"></i>
                        <p style="margin-top: 10px;">âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù…</p>
                    </div>`;
                }
            }

            // -------------------- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© --------------------
            function renderAdminStats() {
                let statsDiv = document.getElementById('adminStats');
                if (!statsDiv) return;
                
                let totalMatchesWeek = matches.length;
                let readyMatchesCount = matches.filter(m => m.type === 'ready').length;
                let normalMatchesCount = matches.filter(m => m.type === 'normal').length;
                let suggestedMatchesCount = matches.filter(m => m.isSuggested === true).length;
                let waitingCount = players.length;
                
                let dayStats = {};
                DAYS.forEach(day => { 
                    dayStats[day] = matches.filter(m => m.day === day).length; 
                });
                
                let dayStatsHtml = '';
                for (let day in dayStats) {
                    if (dayStats[day] > 0) {
                        dayStatsHtml += `<span style="background: #0a6e79; color: white; padding: 4px 12px; border-radius: 30px; margin: 3px; display: inline-block;">${day}: ${dayStats[day]}</span>`;
                    }
                }

                statsDiv.innerHTML = `
                    <div style="display: flex; flex-wrap: wrap; gap: 20px; align-items: flex-start;">
                        <div style="flex: 1; min-width: 200px;">
                            <h4 style="color: #0a6e79; margin-bottom: 12px;"><i class="fas fa-chart-bar"></i> Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h4>
                            <p style="margin: 8px 0;"><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª:</strong> ${totalMatchesWeek}</p>
                            <p style="margin: 8px 0;"><strong>Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø¬Ø§Ù‡Ø²Ø©:</strong> ${readyMatchesCount}</p>
                            <p style="margin: 8px 0;"><strong>Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø¹Ø§Ø¯ÙŠØ©:</strong> ${normalMatchesCount}</p>
                            <p style="margin: 8px 0;"><strong>Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ù…Ù‚ØªØ±Ø­Ø©:</strong> ${suggestedMatchesCount}</p>
                            <p style="margin: 8px 0;"><strong>Ù„Ø§Ø¹Ø¨ÙˆÙ† ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±:</strong> ${waitingCount}</p>
                        </div>
                        <div style="flex: 1; min-width: 200px;">
                            <h4 style="color: #0a6e79; margin-bottom: 12px;"><i class="fas fa-calendar-alt"></i> ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</h4>
                            <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                                ${dayStatsHtml || '<span style="color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª</span>'}
                            </div>
                        </div>
                    </div>
                `;
            }

            // -------------------- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ (Ù…Ø¹ Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©) --------------------
            function renderSchedule() {
                let container = document.getElementById('verticalScheduleContainer');
                if (!container) return;
                let html = '';
                
                DAYS.forEach(day => {
                    html += `<div class="schedule-day" onclick="window.openDeleteModalFromSchedule('${day}')">`;
                    html += `<span class="day-title"><i class="fas fa-calendar-alt"></i> ${day}</span>`;
                    html += `<div class="hours-container">`;
                    
                    HOURS_SIMPLE.forEach((hour, index) => {
                        let match = matches.find(m => m.day === day && m.hour === hour);
                        let cls = 'hour-item';
                        let content = HOURS_DISPLAY[index];
                        
                        if (match) {
                            if (match.type === 'ready') {
                                cls += ' hour-ready';
                                content += ' ğŸ”µ Ø¬Ø§Ù‡Ø²Ø©';
                            } else {
                                cls += ' hour-booked';
                                content += ' ğŸ”´ Ù…Ø¨Ø§Ø±Ø§Ø©';
                                content += ' <span class="invite-badge"><i class="fas fa-check"></i> ØªÙ…Øª</span>';
                                
                                // Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø© Ø®Ø§ØµØ© Ù„Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©
                                if (match.isSuggested) {
                                    cls += ' suggested-hour';
                                    content += ' <span class="invite-badge" style="background: #e0a800;"><i class="fas fa-star"></i> Ù…Ù‚ØªØ±Ø­Ø©</span>';
                                }
                            }
                        } else {
                            content += ' âœ”ï¸';
                        }
                        
                        html += `<div class="${cls}" onclick="event.stopPropagation(); window.openDeleteModalFromHour('${day}', '${hour}')">${content}</div>`;
                    });
                    
                    html += `</div></div>`;
                });
                container.innerHTML = html;
            }

            // -------------------- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ÙØ¦Ø§Øª --------------------
            function renderCategories() {
                let container = document.getElementById('categoriesContainer');
                if (!container) return;
                let html = '';
                
                AGE_CATEGORIES.forEach(cat => {
                    let catPlayers = players.filter(p => p.targetCategory === cat);
                    html += `<div class="category-box">`;
                    html += `<div class="category-header"><span><i class="fas fa-flag"></i> ÙØ¦Ø© ${cat}</span> <span style="background: #146f7a; padding: 4px 18px; border-radius: 40px;">${catPlayers.length} Ù„Ø§Ø¹Ø¨</span></div>`;
                    
                    if (catPlayers.length === 0) {
                        html += `<p style="color: #0f6872; text-align: center; padding: 10px;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</p>`;
                    } else {
                        html += `<div class="player-list">`;
                        catPlayers.sort((a,b) => (a.day + a.hour).localeCompare(b.day + b.hour)).forEach(p => {
                            let hourDisplay = p.hour;
                            const hourIndex = HOURS_SIMPLE.indexOf(p.hour);
                            if (hourIndex !== -1) hourDisplay = HOURS_DISPLAY[hourIndex];
                            
                            html += `<div class="player-row">
                                        <span><i class="fas fa-user"></i> ${p.name} (${p.age})</span>
                                        <span class="player-day"><i class="fas fa-clock"></i> ${p.day} ${hourDisplay}</span>
                                    </div>`;
                        });
                        html += `</div>`;
                    }
                    html += `</div>`;
                });
                container.innerHTML = html;
            }

            // -------------------- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© --------------------
            function renderAdmin() {
                let container = document.getElementById('adminPanelContainer');
                if (!container) return;
                
                renderAdminStats();

                if (matches.length === 0) {
                    container.innerHTML = '<p style="text-align: center; padding: 20px; background: #eef7f9; border-radius: 40px;">ğŸš« Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</p>';
                    return;
                }

                let html = '<div style="overflow-x: auto;"><table class="admin-table"><thead><tr><th>Ø§Ù„ÙŠÙˆÙ…</th><th>Ø§Ù„Ø³Ø§Ø¹Ø©</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„ÙƒÙˆØ¯</th><th>Ø­Ø°Ù</th></tr></thead><tbody>';
                
                matches.sort((a, b) => {
                    const dayOrder = DAYS.indexOf(a.day) - DAYS.indexOf(b.day);
                    if (dayOrder !== 0) return dayOrder;
                    return a.hour.localeCompare(b.hour);
                }).forEach(m => {
                    let hourDisplay = m.hour;
                    const hourIndex = HOURS_SIMPLE.indexOf(m.hour);
                    if (hourIndex !== -1) hourDisplay = HOURS_DISPLAY[hourIndex];
                    
                    let typeDisplay = m.type === 'ready' ? 'ğŸ”µ Ø¬Ø§Ù‡Ø²Ø©' : 'ğŸ”´ Ø¹Ø§Ø¯ÙŠØ©';
                    if (m.isSuggested) typeDisplay += ' â­ Ù…Ù‚ØªØ±Ø­Ø©';
                    
                    html += `<tr>
                        <td>${m.day}</td>
                        <td>${hourDisplay}</td>
                        <td>${typeDisplay}</td>
                        <td style="direction: ltr; font-family: monospace;">${m.code || 'â€”'}</td>`;
                    
                    if (m.type === 'ready' && m.code) {
                        html += `<td><button class="btn-sm btn-warning" style="width: auto; padding: 6px 16px;" onclick="deleteReadyCodeFromAdmin('${m.code}', '${m.day}', '${m.hour}')"><i class="fas fa-trash"></i> Ø­Ø°Ù</button></td>`;
                    } else {
                        html += `<td><button class="btn-sm btn-warning" style="width: auto; padding: 6px 16px;" onclick="deleteNormalMatchFromAdmin('${m.day}', '${m.hour}')"><i class="fas fa-trash"></i> Ø­Ø°Ù</button></td>`;
                    }
                    html += `</tr>`;
                });
                
                html += '</tbody></table></div>';
                container.innerHTML = html;
            }

            // -------------------- Ø±Ù†Ø¯Ø± ÙƒØ§Ù…Ù„ --------------------
            function renderAll() {
                renderSchedule();
                renderCategories();
                updateStats();
            }

            // -------------------- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« --------------------
            function init() {
                console.log('ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…...');
                
                fillHours();
                renderAll();
                updateStats();

                const registerBtn = document.getElementById('registerPlayerBtn');
                if (registerBtn) {
                    registerBtn.addEventListener('click', register);
                    console.log('ØªÙ… ØªÙØ¹ÙŠÙ„ Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨');
                }

                const bookReadyBtn = document.getElementById('bookReadyMatchBtn');
                if (bookReadyBtn) {
                    bookReadyBtn.addEventListener('click', bookReady);
                }
                
                const toggleAdminBtn = document.getElementById('toggleAdminBtn');
                if (toggleAdminBtn) {
                    toggleAdminBtn.addEventListener('click', function() {
                        document.getElementById('adminContent').classList.toggle('hidden');
                    });
                }

                const unlockAdminBtn = document.getElementById('unlockAdminBtn');
                if (unlockAdminBtn) {
                    unlockAdminBtn.addEventListener('click', function() {
                        const adminCode = document.getElementById('adminCode');
                        if (adminCode && adminCode.value === '****') {
                            renderAdmin();
                            showMsg('ğŸ”“ ØªÙ… ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¨Ù†Ø¬Ø§Ø­');
                        } else {
                            showMsg('âŒ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ØºÙŠØ± ØµØ­ÙŠØ­', false);
                        }
                    });
                }

                const resetSystemBtn = document.getElementById('resetSystemBtn');
                if (resetSystemBtn) {
                    resetSystemBtn.addEventListener('click', function() {
                        document.getElementById('resetModal').style.display = 'flex';
                    });
                }

                const confirmResetBtn = document.getElementById('confirmResetBtn');
                if (confirmResetBtn) {
                    confirmResetBtn.addEventListener('click', function() {
                        let resetCode = document.getElementById('resetCode');
                        if (resetCode && resetCode.value === '****') {
                            resetSystem('****');
                            document.getElementById('resetModal').style.display = 'none';
                            if (resetCode) resetCode.value = '';
                        } else {
                            showMsg('âŒ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ØºÙŠØ± ØµØ­ÙŠØ­', false);
                        }
                    });
                }

                const cancelResetBtn = document.getElementById('cancelResetBtn');
                if (cancelResetBtn) {
                    cancelResetBtn.addEventListener('click', function() {
                        document.getElementById('resetModal').style.display = 'none';
                        const resetCode = document.getElementById('resetCode');
                        if (resetCode) resetCode.value = '';
                    });
                }

                const searchPlayerBtn = document.getElementById('searchPlayerBtn');
                if (searchPlayerBtn) {
                    searchPlayerBtn.addEventListener('click', searchPlayer);
                }
                
                const searchPlayerName = document.getElementById('searchPlayerName');
                if (searchPlayerName) {
                    searchPlayerName.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') searchPlayer();
                    });
                }

                const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
                if (confirmDeleteBtn) {
                    confirmDeleteBtn.addEventListener('click', function() {
                        let deleteCode = document.getElementById('deleteCode');
                        if (currentDeleteDay && currentDeleteHour && deleteCode) {
                            deleteMatch(currentDeleteDay, currentDeleteHour, deleteCode.value);
                            document.getElementById('deleteModal').style.display = 'none';
                        }
                    });
                }

                const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
                if (cancelDeleteBtn) {
                    cancelDeleteBtn.addEventListener('click', function() {
                        document.getElementById('deleteModal').style.display = 'none';
                        const deleteCode = document.getElementById('deleteCode');
                        if (deleteCode) deleteCode.value = '';
                    });
                }

                window.addEventListener('click', function(e) {
                    if (e.target.classList.contains('modal')) {
                        document.getElementById('deleteModal').style.display = 'none';
                        document.getElementById('resetModal').style.display = 'none';
                    }
                });
            }

            init();
        })();
    </script>
</body>
</html>
